#!/usr/bin/env bash

if ! git rev-parse --is-inside-work-tree >/dev/null 2>&1; then
  if [[ "$PWD" == "$HOME" ||
        "$PWD" == "$HOME/.config"* ||
        "$PWD" == "$HOME/.local"* ||
        "$PWD" == "$HOME/.ssh"* ]]; then
    export GIT_DIR="$HOME/.dotfiles.git"
    export GIT_WORK_TREE="$HOME"
  fi
fi

# Find the real lazygit (skip this wrapper)
REAL_LAZYGIT=""
IFS=':' read -ra PATH_DIRS <<< "$PATH"
for dir in "${PATH_DIRS[@]}"; do
  candidate="$dir/lazygit"
  if [[ -x "$candidate" && "$candidate" != "$0" ]]; then
    REAL_LAZYGIT="$candidate"
    break
  fi
done

exec "$REAL_LAZYGIT" "$@"
